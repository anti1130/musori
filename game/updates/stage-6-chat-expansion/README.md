# 6ë‹¨ê³„: ì±„íŒ… ê¸°ëŠ¥ í™•ì¥

## ğŸ“‹ ê°œìš”
ê¸°ë³¸ í…ìŠ¤íŠ¸ ì±„íŒ…ì„ ë„˜ì–´ì„œ ìŒì„± ì±„íŒ…, íŒŒì¼ ê³µìœ , ì´ëª¨í‹°ì½˜ ë“± ë‹¤ì–‘í•œ ë¯¸ë””ì–´ë¥¼ ì§€ì›í•˜ëŠ” ê³ ê¸‰ ì±„íŒ… ê¸°ëŠ¥ì„ êµ¬í˜„í•  ì˜ˆì •ì…ë‹ˆë‹¤.

## ğŸ¯ ì£¼ìš” ê¸°ëŠ¥

### 1. ìŒì„± ì±„íŒ… (Voice Chat)
- **WebRTC ê¸°ë°˜**: ì‹¤ì‹œê°„ ìŒì„± í†µí™” ê¸°ëŠ¥
- **1:1 í†µí™”**: ë‘ ì‚¬ìš©ì ê°„ ìŒì„± í†µí™”
- **ê·¸ë£¹ í†µí™”**: ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ì°¸ì—¬í•˜ëŠ” ìŒì„± ì±„íŒ…
- **ìŒì„± í’ˆì§ˆ ì¡°ì •**: ë„¤íŠ¸ì›Œí¬ ìƒí™©ì— ë”°ë¥¸ í’ˆì§ˆ ì¡°ì •

#### ì„¸ë¶€ ê³„íš
- **WebRTC êµ¬í˜„**: RTCPeerConnection, getUserMedia í™œìš©
- **ì‹œê·¸ë„ë§ ì„œë²„**: Socket.ioë¥¼ í†µí•œ ì—°ê²° ì •ë³´ êµí™˜
- **ìŒì„± í’ˆì§ˆ**: Opus ì½”ë± ì‚¬ìš©ìœ¼ë¡œ ê³ í’ˆì§ˆ ìŒì„±
- **ë„¤íŠ¸ì›Œí¬ ì ì‘**: ë„¤íŠ¸ì›Œí¬ ìƒí™©ì— ë”°ë¥¸ ë¹„íŠ¸ë ˆì´íŠ¸ ì¡°ì •

### 2. íŒŒì¼ ê³µìœ  (File Sharing)
- **ë‹¤ì–‘í•œ íŒŒì¼ í˜•ì‹**: ì´ë¯¸ì§€, ë¬¸ì„œ, ë™ì˜ìƒ, ì˜¤ë””ì˜¤ íŒŒì¼
- **ë“œë˜ê·¸ ì•¤ ë“œë¡­**: íŒŒì¼ì„ ì±„íŒ…ì°½ì— ë“œë˜ê·¸í•˜ì—¬ ì—…ë¡œë“œ
- **íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°**: ì´ë¯¸ì§€, PDF ë“± ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥
- **ë‹¤ìš´ë¡œë“œ**: íŒŒì¼ ë‹¤ìš´ë¡œë“œ ë° ì €ì¥ ê¸°ëŠ¥

#### ì„¸ë¶€ ê³„íš
- **Firebase Storage**: íŒŒì¼ ì €ì¥ ë° ê´€ë¦¬
- **íŒŒì¼ í¬ê¸° ì œí•œ**: ìµœëŒ€ 50MBê¹Œì§€ ì—…ë¡œë“œ ê°€ëŠ¥
- **ì§€ì› í˜•ì‹**: 
  - ì´ë¯¸ì§€: JPG, PNG, GIF, WebP
  - ë¬¸ì„œ: PDF, DOC, DOCX, TXT
  - ë™ì˜ìƒ: MP4, WebM, MOV
  - ì˜¤ë””ì˜¤: MP3, WAV, OGG
- **ë³´ì•ˆ**: íŒŒì¼ ìŠ¤ìº” ë° ë°”ì´ëŸ¬ìŠ¤ ê²€ì‚¬

### 3. ì´ëª¨í‹°ì½˜ ì‹œìŠ¤í…œ (Emoji System)
- **ê¸°ë³¸ ì´ëª¨í‹°ì½˜**: Unicode ì´ëª¨í‹°ì½˜ ì§€ì›
- **ì»¤ìŠ¤í…€ ì´ëª¨í‹°ì½˜**: ì‚¬ìš©ì ì œì‘ ì´ëª¨í‹°ì½˜
- **ì´ëª¨í‹°ì½˜ íŒ©**: ë‹¤ì–‘í•œ í…Œë§ˆì˜ ì´ëª¨í‹°ì½˜ íŒ©
- **ìµœê·¼ ì‚¬ìš©**: ìì£¼ ì‚¬ìš©í•˜ëŠ” ì´ëª¨í‹°ì½˜ ë¹ ë¥¸ ì ‘ê·¼

#### ì„¸ë¶€ ê³„íš
- **ì´ëª¨í‹°ì½˜ ì„ íƒê¸°**: í´ë¦­ìœ¼ë¡œ ì´ëª¨í‹°ì½˜ ì„ íƒ
- **ì»¤ìŠ¤í…€ ì´ëª¨í‹°ì½˜**: ì‚¬ìš©ìê°€ ì—…ë¡œë“œí•œ ì´ë¯¸ì§€ ê¸°ë°˜
- **ì´ëª¨í‹°ì½˜ ê²€ìƒ‰**: í‚¤ì›Œë“œë¡œ ì´ëª¨í‹°ì½˜ ê²€ìƒ‰
- **ì´ëª¨í‹°ì½˜ í†µê³„**: ìì£¼ ì‚¬ìš©í•˜ëŠ” ì´ëª¨í‹°ì½˜ ë¶„ì„

## ğŸ”§ ê¸°ìˆ ì  êµ¬í˜„ ê³„íš

### ìŒì„± ì±„íŒ… ì•„í‚¤í…ì²˜
```javascript
// WebRTC ì—°ê²° ê´€ë¦¬
class VoiceChat {
  constructor() {
    this.peerConnection = null;
    this.localStream = null;
    this.remoteStream = null;
    this.socket = io();
  }

  async startCall(targetUserId) {
    // 1. ë¡œì»¬ ìŠ¤íŠ¸ë¦¼ ê°€ì ¸ì˜¤ê¸°
    this.localStream = await navigator.mediaDevices.getUserMedia({
      audio: true,
      video: false
    });

    // 2. RTCPeerConnection ìƒì„±
    this.peerConnection = new RTCPeerConnection({
      iceServers: [
        { urls: 'stun:stun.l.google.com:19302' }
      ]
    });

    // 3. ë¡œì»¬ ìŠ¤íŠ¸ë¦¼ ì¶”ê°€
    this.localStream.getTracks().forEach(track => {
      this.peerConnection.addTrack(track, this.localStream);
    });

    // 4. ì›ê²© ìŠ¤íŠ¸ë¦¼ ì²˜ë¦¬
    this.peerConnection.ontrack = (event) => {
      this.remoteStream = event.streams[0];
    };

    // 5. ì‹œê·¸ë„ë§
    await this.createOffer();
  }
}
```

### íŒŒì¼ ê³µìœ  ì‹œìŠ¤í…œ
```javascript
// íŒŒì¼ ì—…ë¡œë“œ ì»´í¬ë„ŒíŠ¸
const FileUpload = ({ onFileUpload }) => {
  const [uploading, setUploading] = useState(false);
  const [progress, setProgress] = useState(0);

  const handleFileUpload = async (file) => {
    if (file.size > 50 * 1024 * 1024) { // 50MB ì œí•œ
      alert('íŒŒì¼ í¬ê¸°ëŠ” 50MBë¥¼ ì´ˆê³¼í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
      return;
    }

    setUploading(true);
    const storageRef = ref(storage, `files/${Date.now()}_${file.name}`);
    
    const uploadTask = uploadBytesResumable(storageRef, file);
    
    uploadTask.on('state_changed',
      (snapshot) => {
        const progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
        setProgress(progress);
      },
      (error) => {
        console.error('Upload error:', error);
        setUploading(false);
      },
      async () => {
        const downloadURL = await getDownloadURL(uploadTask.snapshot.ref);
        onFileUpload({
          name: file.name,
          size: file.size,
          type: file.type,
          url: downloadURL
        });
        setUploading(false);
        setProgress(0);
      }
    );
  };

  return (
    <div>
      <input
        type="file"
        onChange={(e) => handleFileUpload(e.target.files[0])}
        accept="image/*,video/*,audio/*,.pdf,.doc,.docx,.txt"
        style={{ display: 'none' }}
        id="file-upload"
      />
      <label htmlFor="file-upload" style={{ cursor: 'pointer' }}>
        ğŸ“ íŒŒì¼ ì²¨ë¶€
      </label>
      {uploading && (
        <div>
          ì—…ë¡œë“œ ì¤‘... {Math.round(progress)}%
        </div>
      )}
    </div>
  );
};
```

### ì´ëª¨í‹°ì½˜ ì‹œìŠ¤í…œ
```javascript
// ì´ëª¨í‹°ì½˜ ì„ íƒê¸° ì»´í¬ë„ŒíŠ¸
const EmojiPicker = ({ onEmojiSelect }) => {
  const [showPicker, setShowPicker] = useState(false);
  const [searchTerm, setSearchTerm] = useState('');

  const emojiCategories = [
    { name: 'ìµœê·¼', emojis: recentEmojis },
    { name: 'í‘œì •', emojis: smileyEmojis },
    { name: 'ë™ë¬¼', emojis: animalEmojis },
    { name: 'ìŒì‹', emojis: foodEmojis },
    { name: 'í™œë™', emojis: activityEmojis },
    { name: 'ì—¬í–‰', emojis: travelEmojis },
    { name: 'ê°ì²´', emojis: objectEmojis },
    { name: 'ì‹¬ë³¼', emojis: symbolEmojis },
    { name: 'ê¹ƒë°œ', emojis: flagEmojis }
  ];

  const handleEmojiClick = (emoji) => {
    onEmojiSelect(emoji);
    // ìµœê·¼ ì‚¬ìš© ì´ëª¨í‹°ì½˜ì— ì¶”ê°€
    addToRecentEmojis(emoji);
    setShowPicker(false);
  };

  return (
    <div style={{ position: 'relative' }}>
      <button onClick={() => setShowPicker(!showPicker)}>
        ğŸ˜Š
      </button>
      
      {showPicker && (
        <div style={{
          position: 'absolute',
          bottom: '100%',
          left: 0,
          background: colors.bg,
          border: `1px solid ${colors.border}`,
          borderRadius: '8px',
          padding: '12px',
          width: '300px',
          maxHeight: '400px',
          overflowY: 'auto',
          zIndex: 1000
        }}>
          <input
            type="text"
            placeholder="ì´ëª¨í‹°ì½˜ ê²€ìƒ‰..."
            value={searchTerm}
            onChange={(e) => setSearchTerm(e.target.value)}
            style={{
              width: '100%',
              padding: '8px',
              marginBottom: '12px',
              borderRadius: '4px',
              border: `1px solid ${colors.border}`
            }}
          />
          
          {emojiCategories.map(category => (
            <div key={category.name}>
              <div style={{
                fontSize: '12px',
                fontWeight: 'bold',
                color: colors.text,
                marginBottom: '8px'
              }}>
                {category.name}
              </div>
              <div style={{
                display: 'grid',
                gridTemplateColumns: 'repeat(8, 1fr)',
                gap: '4px'
              }}>
                {category.emojis
                  .filter(emoji => 
                    emoji.name.toLowerCase().includes(searchTerm.toLowerCase())
                  )
                  .map(emoji => (
                    <button
                      key={emoji.unicode}
                      onClick={() => handleEmojiClick(emoji.unicode)}
                      style={{
                        fontSize: '20px',
                        padding: '4px',
                        border: 'none',
                        background: 'transparent',
                        cursor: 'pointer',
                        borderRadius: '4px'
                      }}
                      onMouseEnter={(e) => {
                        e.target.style.background = colors.hover;
                      }}
                      onMouseLeave={(e) => {
                        e.target.style.background = 'transparent';
                      }}
                    >
                      {emoji.unicode}
                    </button>
                  ))}
              </div>
            </div>
          ))}
        </div>
      )}
    </div>
  );
};
```

## ğŸ¨ UI/UX ì„¤ê³„

### ìŒì„± ì±„íŒ… UI
- **í†µí™” ë²„íŠ¼**: ìŒì„± í†µí™” ì‹œì‘/ì¢…ë£Œ ë²„íŠ¼
- **ìŒëŸ‰ í‘œì‹œ**: ì‹¤ì‹œê°„ ìŒëŸ‰ ë ˆë²¨ í‘œì‹œ
- **í†µí™” ìƒíƒœ**: ì—°ê²° ì¤‘, í†µí™” ì¤‘, ì¢…ë£Œ ìƒíƒœ í‘œì‹œ
- **ìŒì†Œê±° ë²„íŠ¼**: ë§ˆì´í¬ ìŒì†Œê±°/í•´ì œ

### íŒŒì¼ ê³µìœ  UI
- **ë“œë˜ê·¸ ì˜ì—­**: íŒŒì¼ì„ ë“œë˜ê·¸í•  ìˆ˜ ìˆëŠ” ì˜ì—­
- **íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°**: ì´ë¯¸ì§€, PDF ë“± ë¯¸ë¦¬ë³´ê¸°
- **ì§„í–‰ë¥  ë°”**: íŒŒì¼ ì—…ë¡œë“œ ì§„í–‰ë¥  í‘œì‹œ
- **íŒŒì¼ ëª©ë¡**: ê³µìœ ëœ íŒŒì¼ ëª©ë¡ í‘œì‹œ

### ì´ëª¨í‹°ì½˜ UI
- **ì´ëª¨í‹°ì½˜ ë²„íŠ¼**: ì´ëª¨í‹°ì½˜ ì„ íƒê¸° ì—´ê¸°
- **ì¹´í…Œê³ ë¦¬ íƒ­**: ì´ëª¨í‹°ì½˜ ì¹´í…Œê³ ë¦¬ë³„ ë¶„ë¥˜
- **ê²€ìƒ‰ ê¸°ëŠ¥**: ì´ëª¨í‹°ì½˜ ê²€ìƒ‰
- **ìµœê·¼ ì‚¬ìš©**: ìì£¼ ì‚¬ìš©í•˜ëŠ” ì´ëª¨í‹°ì½˜

## ğŸ“Š êµ¬í˜„ ìš°ì„ ìˆœìœ„

### Phase 1: ì´ëª¨í‹°ì½˜ ì‹œìŠ¤í…œ (1-2ì£¼)
1. ê¸°ë³¸ ì´ëª¨í‹°ì½˜ ì„ íƒê¸° êµ¬í˜„
2. ì´ëª¨í‹°ì½˜ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜
3. ìµœê·¼ ì‚¬ìš© ì´ëª¨í‹°ì½˜ ê¸°ëŠ¥

### Phase 2: íŒŒì¼ ê³µìœ  (2-3ì£¼)
1. íŒŒì¼ ì—…ë¡œë“œ ì‹œìŠ¤í…œ
2. íŒŒì¼ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥
3. íŒŒì¼ ë‹¤ìš´ë¡œë“œ ê¸°ëŠ¥

### Phase 3: ìŒì„± ì±„íŒ… (4-6ì£¼)
1. WebRTC ê¸°ë³¸ ì—°ê²°
2. 1:1 ìŒì„± í†µí™”
3. ê·¸ë£¹ ìŒì„± ì±„íŒ…

## ğŸ§ª í…ŒìŠ¤íŠ¸ ê³„íš

### ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] ì´ëª¨í‹°ì½˜ ì„ íƒ ë° ì „ì†¡
- [ ] íŒŒì¼ ì—…ë¡œë“œ ë° ë‹¤ìš´ë¡œë“œ
- [ ] ìŒì„± í†µí™” ì—°ê²° ë° í†µí™”
- [ ] íŒŒì¼ í˜•ì‹ë³„ ë¯¸ë¦¬ë³´ê¸°

### ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
- [ ] ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ ì„±ëŠ¥
- [ ] ìŒì„± í’ˆì§ˆ ë° ì§€ì—°ì‹œê°„
- [ ] ë™ì‹œ ì‚¬ìš©ì ì²˜ë¦¬ ì„±ëŠ¥

### ë³´ì•ˆ í…ŒìŠ¤íŠ¸
- [ ] íŒŒì¼ ì—…ë¡œë“œ ë³´ì•ˆ ê²€ì¦
- [ ] ìŒì„± í†µí™” ì•”í˜¸í™”
- [ ] ì•…ì„± íŒŒì¼ ì°¨ë‹¨

## ğŸ”„ ì˜ˆìƒ ë¬¸ì œì  ë° í•´ê²°ë°©ì•ˆ

### 1. WebRTC ì—°ê²° ë¬¸ì œ
**ë¬¸ì œ**: NAT/ë°©í™”ë²½ìœ¼ë¡œ ì¸í•œ ì—°ê²° ì‹¤íŒ¨
**í•´ê²°**: TURN ì„œë²„ êµ¬ì¶•, STUN ì„œë²„ í™œìš©

### 2. íŒŒì¼ ì—…ë¡œë“œ ì„±ëŠ¥
**ë¬¸ì œ**: ëŒ€ìš©ëŸ‰ íŒŒì¼ ì—…ë¡œë“œ ì‹œ ì„±ëŠ¥ ì €í•˜
**í•´ê²°**: ì²­í¬ ì—…ë¡œë“œ, ì§„í–‰ë¥  í‘œì‹œ, ë°±ê·¸ë¼ìš´ë“œ ì—…ë¡œë“œ

### 3. ë¸Œë¼ìš°ì € í˜¸í™˜ì„±
**ë¬¸ì œ**: ë‹¤ì–‘í•œ ë¸Œë¼ìš°ì €ì—ì„œì˜ í˜¸í™˜ì„± ë¬¸ì œ
**í•´ê²°**: í´ë¦¬í•„ ì‚¬ìš©, ë¸Œë¼ìš°ì €ë³„ ìµœì í™”

## ğŸ“ ì½”ë“œ ì˜ˆì‹œ (ê³„íš)

### ìŒì„± ì±„íŒ… ì»´í¬ë„ŒíŠ¸
```javascript
const VoiceChat = ({ targetUser, onCallEnd }) => {
  const [isCalling, setIsCalling] = useState(false);
  const [isMuted, setIsMuted] = useState(false);
  const [callDuration, setCallDuration] = useState(0);

  const startCall = async () => {
    try {
      setIsCalling(true);
      // WebRTC ì—°ê²° ì‹œì‘
      await voiceChat.startCall(targetUser.uid);
    } catch (error) {
      console.error('Call failed:', error);
      setIsCalling(false);
    }
  };

  const endCall = () => {
    voiceChat.endCall();
    setIsCalling(false);
    onCallEnd();
  };

  const toggleMute = () => {
    voiceChat.toggleMute();
    setIsMuted(!isMuted);
  };

  return (
    <div style={{
      position: 'fixed',
      bottom: '20px',
      right: '20px',
      background: colors.bg,
      border: `1px solid ${colors.border}`,
      borderRadius: '12px',
      padding: '16px',
      boxShadow: '0 4px 12px rgba(0,0,0,0.15)'
    }}>
      {isCalling ? (
        <div>
          <div>ğŸ“ {targetUser.nickname}ì™€ í†µí™” ì¤‘</div>
          <div>â±ï¸ {formatDuration(callDuration)}</div>
          <button onClick={toggleMute}>
            {isMuted ? 'ğŸ”‡' : 'ğŸ¤'} {isMuted ? 'ìŒì†Œê±° í•´ì œ' : 'ìŒì†Œê±°'}
          </button>
          <button onClick={endCall} style={{ color: 'red' }}>
            ğŸ“ í†µí™” ì¢…ë£Œ
          </button>
        </div>
      ) : (
        <button onClick={startCall}>
          ğŸ“ {targetUser.nickname}ì—ê²Œ ì „í™”
        </button>
      )}
    </div>
  );
};
```

## ğŸ¯ ì™„ë£Œ ê¸°ì¤€

### ì´ëª¨í‹°ì½˜ ì‹œìŠ¤í…œ
- [ ] ê¸°ë³¸ ì´ëª¨í‹°ì½˜ ì„ íƒê¸°
- [ ] ì´ëª¨í‹°ì½˜ ì¹´í…Œê³ ë¦¬ ë¶„ë¥˜
- [ ] ìµœê·¼ ì‚¬ìš© ì´ëª¨í‹°ì½˜
- [ ] ì´ëª¨í‹°ì½˜ ê²€ìƒ‰ ê¸°ëŠ¥

### íŒŒì¼ ê³µìœ 
- [ ] íŒŒì¼ ì—…ë¡œë“œ ì‹œìŠ¤í…œ
- [ ] íŒŒì¼ ë¯¸ë¦¬ë³´ê¸°
- [ ] íŒŒì¼ ë‹¤ìš´ë¡œë“œ
- [ ] ë“œë˜ê·¸ ì•¤ ë“œë¡­

### ìŒì„± ì±„íŒ…
- [ ] WebRTC ì—°ê²°
- [ ] 1:1 ìŒì„± í†µí™”
- [ ] ìŒì†Œê±° ê¸°ëŠ¥
- [ ] í†µí™” ìƒíƒœ í‘œì‹œ

**ì˜ˆìƒ ì™„ë£Œì¼**: 2024ë…„ (10-12ì£¼ ì†Œìš”)
**ìƒíƒœ**: ğŸ“‹ ê³„íš ì¤‘ 